SELECT tblTeachers.fldFirstName, tblTeachers.fldLastName,  count(tblStudents.fldFirstName) AS total FROM tblSections JOIN tblEnrolls ON tblSections.fldCRN  = tblEnrolls.`fnkSectionId` JOIN tblStudents ON pmkStudentId = fnkStudentId JOIN tblTeachers ON tblSections.fnkTeacherNetId=pmkNetId WHERE fldType != "LAB" GROUP BY fnkTeacherNetId ORDER BY total DESC